@model ClientLoad

@using ACT.Core.Enums
@using ACT.Data.Models;

@{
    if ( ViewBag.IncludeLayout == null )
    {
        Layout = null;
    }

    ViewBag.Title = "Details";

    List<ChepLoad> chepLoads = ViewBag.ChepLoads;
}

@if ( ViewBag.IncludeLayout != null )
{
    <h2>
        <img alt="" src="@Url.Content( "~/images/info.png" )" />
        <span>Client Data Details</span>
    </h2>
}

<div id="item-details" class="item-details" style="width: auto;">

    @if ( ViewBag.IncludeLayout == null )
    {
        <h2>
            <img alt="" src="@Url.Content( "~/images/info.png" )" />
            <span>Client Data Details</span>
        </h2>
    }

    <div class="left" style="width: 31%; margin-right: 3%;">

        <div class="display-label ">
            Client
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.Client.CompanyName )
        </div>

        <div class="display-label ">
            Vehicle
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.Vehicle.Descriptoin )
        </div>

        <div class="display-label ">
            Client Site
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ClientSite.Site.Description )
        </div>

        <div class="display-label ">
            Transporter
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.Transporter.Name )
        </div>

        <div class="display-label ">
            Outstanding Reason
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.OutstandingReason.Description )
        </div>

        <div class="display-label ">
            Status
        </div>
        <div class="display-field">
            @( ( ( ReconciliationStatus ) Model.Status ).GetDisplayText() )
        </div>

        <div class="display-label ">
            Reconcile Invoice
        </div>
        <div class="display-field">
            @( Model.ReconcileInvoice == true ? "YES" : "NO" )
        </div>


        <div class="display-label">
            Load Date
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.LoadDate )
        </div>

        <div class="display-label">
            Effective Date
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.EffectiveDate )
        </div>

        <div class="display-label">
            Notify Date
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.NotifyDate )
        </div>

    </div>

    <div class="left" style="width: 31%; margin-right: 3%;">

        <div class="display-label ">
            Original Quantity
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.OriginalQuantity )
        </div>

        <div class="display-label ">
            Return Quantity
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ReturnQty )
        </div>

        <div class="display-label ">
            New Quantity
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.NewQuantity )
        </div>

        <div class="display-label ">
            Outstanding Quantity
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.OutstandingQty )
        </div>

        <div class="display-label ">
            Debrief Quantity
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.DebriefQty )
        </div>

        <div class="display-label ">
            Admin Movement
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.AdminMovement )
        </div>

        <div class="display-label ">
            POD
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.PODNumber )
        </div>

        <div class="display-label ">
            PCN
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.PCNNumber )
        </div>

        <div class="display-label ">
            PRN
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.PRNNumber )
        </div>

        <div class="display-label">
            Reconcile Date
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ReconcileDate )
        </div>

    </div>

    <div class="left" style="width: 31%;">

        <div class="display-label ">
            Load #
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.LoadNumber )
        </div>

        <div class="display-label ">
            Account #
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.AccountNumber )
        </div>

        <div class="display-label ">
            Client Description
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ClientDescription )
        </div>

        <div class="display-label ">
            Reference #
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ReferenceNumber )
        </div>

        <div class="display-label ">
            Receiver #
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ReceiverNumber )
        </div>

        <div class="display-label ">
            Equipment
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.Equipment )
        </div>

        <div class="display-label ">
            Delivery Note #
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.DeliveryNote )
        </div>

        <div class="display-label ">
            Chep Invoice #
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ChepInvoiceNo )
        </div>

        <div class="display-label ">
            Chep Compensation #
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.ChepCompensationNo )
        </div>

        <div class="display-label ">
            THAN
        </div>
        <div class="display-field">
            @Html.DisplayFor( model => model.THAN )
        </div>

    </div>

    @if ( ViewBag.CanEdit == true )
    {
        <div class="clear" style="border-bottom: 1px dashed #ccc; margin: 20px 0; height: 0;">&nbsp;</div>

        <p>
            <strong>Chep Loads (@chepLoads.NullableCount())</strong>
        </p>

        <table id="chep-loads-table" class="da-table small">

            <thead>
                <tr>
                    <th>
                        #
                    </th>
                    <th>
                        Load Date
                    </th>
                    <th>
                        Created
                    </th>
                    <th>
                        Docket #
                    </th>
                    <th>
                        Ref #
                    </th>
                    <th>
                        Equipment
                    </th>
                    <th>
                        Invoice #
                    </th>
                    <th>
                        Transaction Type
                    </th>
                    <th>
                        Qty
                    </th>
                    <th>
                        Status
                    </th>
                    <th >
                        Balanced
                    </th>
                    <th>
                        Actions
                    </th>
                </tr>
            </thead>

            <tbody>

                @if ( chepLoads.NullableAny() )
                {
                    int count = 1;

                    foreach ( ChepLoad item in chepLoads )
                    {
                        PostingType postingType = ( PostingType ) item.PostingType;
                        BalanceStatus balanceStatus = ( BalanceStatus ) item.BalanceStatus;
                        ReconciliationStatus status = ( ReconciliationStatus ) item.Status;

                        string active = status == ReconciliationStatus.Reconciled ? "active" : "inactive";

                        <tr id="tr-@item.Id-chep-load-item" class="tr-@item.Id-chep-load-item @active">

                            <td width="1%">
                                @count
                            </td>
                            <td>
                                @(item.EffectiveDate?.ToString( "yyyy-MM-dd" ))
                            </td>
                            <td>
                                On @(item.CreateDate?.ToString( "yyyy-MM-dd" ) ) <br /> by @item.CreatedBy
                            </td>
                            <td>
                                @item.DocketNumber
                            </td>
                            <td>
                                @item.Ref
                            </td>
                            <td>
                                @item.Equipment
                            </td>
                            <td>
                                @item.InvoiceNumber
                            </td>
                            <td>
                                @item.TransactionType
                            </td>
                            <td>
                                @item.Quantity
                            </td>
                            <td>
                                @status.GetDisplayText()
                            </td>
                            <td>
                                @balanceStatus.GetDisplayText()
                            </td>
                            <td width="5%">

                                @Html.ActionLink( "Details", "PoolingAgentDataDetails", new { id = item.Id, CanEdit = false }, new { @class = "info", @data_details = "1", @data_id = item.Id, @data_target = ".tr-" + item.Id + "-chep-load-item" } )

                            </td>

                        </tr>

                        count++;
                    }
                }

            </tbody>

        </table>
    }

    <div class="clear" style="border-bottom: 1px dashed #ccc; margin: 20px 0; height: 0;">&nbsp;</div>

    @if ( ViewBag.IncludeLayout == null )
    {
        <p>
            @if ( ViewBag.CanEdit == true )
            {
                <span>
                    @Html.ActionLink( "Edit", "EditClientData", new { id = Model.Id }, new { @class = "edit", @data_edit = "1", @data_id = Model.Id, @data_target = "#tr-" + Model.Id + "-item" } )
                </span>
                <span style="padding: 0 5px;">/</span>
            }
            @if ( ViewBag.IncludeLayout == null )
            {
                <a data-cancel="1" data-target="#item-details" data-remove="tr.edit">Cancel</a>
            }
        </p>
    }

    @if ( ViewBag.IncludeLayout != null )
    {
        <div class="back-to-list">
            @Html.ActionLink( "Back to List", "Index" )
        </div>
    }

</div>
